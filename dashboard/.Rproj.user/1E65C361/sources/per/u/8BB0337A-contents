library(dplyr)

# Read the CSV data
data <- read.csv("YokyoFile.csv", stringsAsFactors = FALSE)

# Group the data by Country and RequestedPage, and calculate the count
grouped_data <- data %>%
  group_by(Country, RequestedPage) %>%
  summarize(Visits = n())

# Find the most visited page for each country
most_visited <- grouped_data %>%
  group_by(Country) %>%
  filter(Visits == max(Visits)) %>%
  slice(1)  # Select only the first row if there are multiple equal highest views

# Find the least visited page for each country
least_visited <- grouped_data %>%
  group_by(Country) %>%
  filter(Visits == min(Visits)) %>%
  slice(1)  # Select only the first row if there are multiple equal highest views

# Drop the last column
most_visited <- subset(most_visited, select = -ncol(most_visited))
least_visited <- subset(least_visited, select = -ncol(least_visited))

# Rename the column
most_visited <- rename(most_visited, Most_Viewed = RequestedPage)
least_visited <- rename(least_visited, Least_Viewed = RequestedPage)

# Perform the join operation
merged_df <- merge(most_visited, least_visited, by = "Country")
